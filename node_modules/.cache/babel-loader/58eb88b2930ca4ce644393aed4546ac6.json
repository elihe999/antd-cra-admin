{"ast":null,"code":"import _defineProperty from \"/home/eligit2/ateapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nvar _jsxFileName = \"/home/eligit2/ateapp/src/components/SiderCustom.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\r\n * Created by hao.cheng on 2017/4/13.\r\n */\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport routes from '../routes/config';\nimport SiderMenu from './SiderMenu';\nconst Sider = _Layout.Sider;\n\nclass SiderCustom extends Component {\n  static getDerivedStateFromProps(props, state) {\n    if (props.collapsed !== state.collapsed) {\n      const state1 = SiderCustom.setMenuOpen(props);\n      const state2 = SiderCustom.onCollapse(props.collapsed);\n      return _objectSpread({}, state1, {}, state2, {\n        firstHide: state.collapsed !== props.collapsed && props.collapsed,\n        // 两个不等时赋值props属性值否则为false\n        openKey: state.openKey || !props.collapsed && state1.openKey\n      });\n    }\n\n    return null;\n  }\n\n  // state =\n  constructor(props) {\n    super(props);\n\n    this.menuClick = e => {\n      this.setState({\n        selectedKey: e.key\n      });\n      const popoverHide = this.props.popoverHide; // 响应式布局控制小屏幕点击菜单时隐藏菜单操作\n\n      popoverHide && popoverHide();\n    };\n\n    this.openMenu = v => {\n      this.setState({\n        openKey: v[v.length - 1],\n        firstHide: false\n      });\n    };\n\n    this.state = {\n      mode: 'inline',\n      openKey: '',\n      selectedKey: '',\n      firstHide: true // 点击收缩菜单，第一次隐藏展开子菜单，openMenu时恢复\n\n    };\n  }\n\n  componentDidMount() {\n    // this.setMenuOpen(this.props);\n    const state = SiderCustom.setMenuOpen(this.props);\n    this.setState(state);\n  }\n\n  render() {\n    const _this$state = this.state,\n          selectedKey = _this$state.selectedKey,\n          openKey = _this$state.openKey,\n          firstHide = _this$state.firstHide,\n          collapsed = _this$state.collapsed;\n    return React.createElement(Sider, {\n      trigger: null,\n      breakpoint: \"lg\",\n      collapsed: collapsed,\n      style: {\n        overflowY: 'auto'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"logo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }), React.createElement(SiderMenu, {\n      menus: routes.menus,\n      onClick: this.menuClick,\n      mode: \"inline\",\n      selectedKeys: [selectedKey],\n      openKeys: firstHide ? [] : [openKey],\n      onOpenChange: this.openMenu,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }), React.createElement(\"style\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"\\n                    #nprogress .spinner{\\n                        left: \".concat(collapsed ? '70px' : '206px', \";\\n                        right: 0 !important;\\n                    }\\n                    \")));\n  }\n\n}\n\nSiderCustom.setMenuOpen = props => {\n  const pathname = props.location.pathname;\n  return {\n    openKey: pathname.substr(0, pathname.lastIndexOf('/')),\n    selectedKey: pathname\n  };\n};\n\nSiderCustom.onCollapse = collapsed => {\n  return {\n    collapsed,\n    // firstHide: collapsed,\n    mode: collapsed ? 'vertical' : 'inline'\n  };\n};\n\nexport default withRouter(SiderCustom);","map":{"version":3,"sources":["/home/eligit2/ateapp/src/components/SiderCustom.tsx"],"names":["React","Component","withRouter","routes","SiderMenu","Sider","SiderCustom","getDerivedStateFromProps","props","state","collapsed","state1","setMenuOpen","state2","onCollapse","firstHide","openKey","constructor","menuClick","e","setState","selectedKey","key","popoverHide","openMenu","v","length","mode","componentDidMount","render","overflowY","menus","pathname","location","substr","lastIndexOf"],"mappings":"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","sourcesContent":["/**\r\n * Created by hao.cheng on 2017/4/13.\r\n */\r\nimport React, { Component } from 'react';\r\nimport { Layout } from 'antd';\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\r\nimport routes from '../routes/config';\r\nimport SiderMenu from './SiderMenu';\r\n\r\nconst { Sider } = Layout;\r\n\r\ntype SiderCustomProps = RouteComponentProps<any> & {\r\n    popoverHide?: () => void;\r\n    collapsed?: boolean;\r\n};\r\ntype SiderCustomState = {\r\n    collapsed?: boolean;\r\n    openKey: string;\r\n    firstHide: boolean;\r\n    selectedKey: string;\r\n    mode: string;\r\n};\r\n\r\nclass SiderCustom extends Component<SiderCustomProps, SiderCustomState> {\r\n    static getDerivedStateFromProps(props: any, state: any) {\r\n        if (props.collapsed !== state.collapsed) {\r\n            const state1 = SiderCustom.setMenuOpen(props);\r\n            const state2 = SiderCustom.onCollapse(props.collapsed);\r\n            return {\r\n                ...state1,\r\n                ...state2,\r\n                firstHide: state.collapsed !== props.collapsed && props.collapsed, // 两个不等时赋值props属性值否则为false\r\n                openKey: state.openKey || (!props.collapsed && state1.openKey),\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    static setMenuOpen = (props: any) => {\r\n        const { pathname } = props.location;\r\n        return {\r\n            openKey: pathname.substr(0, pathname.lastIndexOf('/')),\r\n            selectedKey: pathname,\r\n        };\r\n    };\r\n    static onCollapse = (collapsed: boolean) => {\r\n        return {\r\n            collapsed,\r\n            // firstHide: collapsed,\r\n            mode: collapsed ? 'vertical' : 'inline',\r\n        };\r\n    };\r\n    // state =\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            mode: 'inline',\r\n            openKey: '',\r\n            selectedKey: '',\r\n            firstHide: true, // 点击收缩菜单，第一次隐藏展开子菜单，openMenu时恢复\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        // this.setMenuOpen(this.props);\r\n        const state = SiderCustom.setMenuOpen(this.props);\r\n        this.setState(state);\r\n    }\r\n    menuClick = (e: any) => {\r\n        this.setState({\r\n            selectedKey: e.key,\r\n        });\r\n        const { popoverHide } = this.props; // 响应式布局控制小屏幕点击菜单时隐藏菜单操作\r\n        popoverHide && popoverHide();\r\n    };\r\n    openMenu = (v: string[]) => {\r\n        this.setState({\r\n            openKey: v[v.length - 1],\r\n            firstHide: false,\r\n        });\r\n    };\r\n    render() {\r\n        const { selectedKey, openKey, firstHide, collapsed } = this.state;\r\n        return (\r\n            <Sider\r\n                trigger={null}\r\n                breakpoint=\"lg\"\r\n                collapsed={collapsed}\r\n                style={{ overflowY: 'auto' }}\r\n            >\r\n                <div className=\"logo\" />\r\n                <SiderMenu\r\n                    menus={routes.menus}\r\n                    onClick={this.menuClick}\r\n                    mode=\"inline\"\r\n                    selectedKeys={[selectedKey]}\r\n                    openKeys={firstHide ? [] : [openKey]}\r\n                    onOpenChange={this.openMenu}\r\n                />\r\n                <style>\r\n                    {`\r\n                    #nprogress .spinner{\r\n                        left: ${collapsed ? '70px' : '206px'};\r\n                        right: 0 !important;\r\n                    }\r\n                    `}\r\n                </style>\r\n            </Sider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(SiderCustom);\r\n"]},"metadata":{},"sourceType":"module"}